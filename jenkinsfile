node {
    def app

    stage('Clone repository') {
        /* Let's make sure we have the repository cloned to our workspace */
        checkout scm
    }

    stage('building and pushing to docker registery ') {
        /* This builds the actual image; synonymous to
         * docker build on the command line */
        echo 'Waiting 5 minutes for deployment to complete prior starting smoke testing'
        sleep 500 // seconds
    }

        stage('setting kubeconfig ') {
        /* This builds the actual image; synonymous to
         * docker build on the command line */
        sh 'export KUBECONFIG=/bin/kube-config-mel01-mycluster.yml'
        sleep 500 // seconds
    }

        stage('redeploy the deployment to kubernetes ') {
        /* This builds the actual image; synonymous to
         * docker build on the command line */
          sh 'kubectl delete deployments angular '
          sh 'kubectl apply -f service-deployment.yml '
          
    }

}